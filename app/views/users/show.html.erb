
<%if @user.admin == true %>
<!-- Admin User Show -->
  <div style="margin-left: 1rem; margin-top: 1rem; margin-right: 1rem;">
    <div class="row">
      <div class="col-12">
         <h2>Admin Dashboard</h2>
      </div>  
    </div>

    <table class="table ">
      <thead>
        <tr>
          <th scope="col">User ID</th>
          <th scope="col">First Name</th>
          <th scope="col">Last Name</th>
          <th scope="col">Location</th>
          <th scope="col">ISP</th>
          <th scope="col">Bandwidth</th>
          <th scope="col">Email</th>
          <th scope="col">Paypal</th>
          <th scope="col">ISP Verification</th>
          <th scope="col">User Verification</th>
          <th scope="col">Approve</th>
        </tr>
      </thead>
  
      <tbody>
        <%@users.where(form_status: "pending").each do |u|%>
          <tr>
            <!-- <th scope="row">1</th> -->
            <td><%=u.id%></td>
            <td><%=u.first_name%></td>
            <td><%=u.last_name%></td>
            <td><%=u.country%>, <%=u.city%>, <%=u.postcode%></td>
            <td><%=u.isp%></td>
            <td><%=u.bandwidth%></td>
            <td><%=u.email%></td>
            <td><%=u.paypal%></td>
            <td><button class="modal_button" id=<%=u.id.to_s%>>Click me!</button></td>
          </tr>

          <div class="modal fade" id="modal_id_<%=u.id%>" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
              <img id="modal_image" src="<%= @users.find(id=u.id).isp_bill%>">
            </div>
          </div>

        <%end%>
      </tbody>
    </table>
  </div>



 











  



<%else%>
<!-- Normal User Show -->
  <br>
  <div class="container">
     <div class="row">
        <div class="col-12">
           <h2>Your Dashboard</h3>
        </div> 
     </div>
     <br>
     <div class="row">
        <div class="col-9">
        <h3>Status</h3>

         <div>
            Current IP: <%= request.env['REMOTE_ADDR']%>
           <br>
           <% country = GeoIP.new('GeoIP.dat').country("210.195.39.201") %>
           <!-- ^^TESTING must change later -->      
           Country:<%= country.country_name%>
           
           <br>
           City:<% city = GeoIP.new('GeoLiteCity.dat').city("210.195.39.201")%> 
           <!-- ^^TESTING must change later -->      
           <%= city.city_name%>
           <br>
           Time Zone: <%=city.timezone%>
         </div>
         <br>
         <div id="map">   
         </div>
        </div>
        <div class="col-3">
        <h3>Registration Status</h3>
            <div>
              <%if @user.form_status != nil%>
                <p>Name: <%=@user.first_name%>
                <%=@user.last_name%></p>
                <p>Country: <%=@user.country%></p>
                <p>City: <%=@user.city%></p>
                <p>Postcode: <%=@user.postcode%></p>
                <p>Paypal: <%=@user.paypal%></p>
                <p>ISP: <%=@user.isp%></p>
                <p>Bandwidth<%=@user.bandwidth%></p>

              <%else%>
              <%end%>

            </div>

        <%= button_to "Complete Registration", edit_user_url, method: :get%>
        </div>
     </div>
  </div>

    <script>
          function initMap() {
            var uluru = {lat: <%=city.latitude%>, lng: <%=city.longitude%>};
            var map = new google.maps.Map(document.getElementById('map'), {
              zoom: 10,
              center: uluru
            });
            var marker = new google.maps.Marker({
              position: uluru,
              map: map
            });
          }
        </script>


    <!-- Dont know how this is working without a key? -->
    <script async defer
    src=<%="https://maps.googleapis.com/maps/api/js?key="+ENV['google_key']+"&callback=initMap"%>
    </script>

<%end%>


